{"version":3,"sources":["../../src/pages/listing-mapview/listing-mapview.module.ts","../../src/pages/listing-mapview/listing-mapview.ts"],"names":[],"mappings":"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","file":"9.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ListingMapviewPage } from './listing-mapview';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ListingMapviewPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ListingMapviewPage),\r\n  ],\r\n})\r\nexport class ListingMapviewPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/listing-mapview/listing-mapview.module.ts","import { Component, NgZone,ViewChild, ElementRef } from '@angular/core';\nimport { IonicPage, NavController,\nNavParams,ActionSheetController,LoadingController,Events,ViewController,App\n,AlertController, Platform, ToastController } from 'ionic-angular';\nimport { Observable } from 'rxjs/Observable';\nimport {Geolocation} from '@ionic-native/geolocation'\nimport { CommonProvider } from '../../providers/common/common';\nimport { UserManagerProvider } from '../../providers/user-manager/user-manager';\nimport { PropertyProvider } from '../../providers/property/property';\ndeclare var MarkerClusterer: any ;\ndeclare var google;\nvar markersArray = [];\n\ndeclare var google;\nvar addr;\n@IonicPage()\n@Component({\n  selector: 'page-listing-mapview',\n  templateUrl: 'listing-mapview.html',\n})\nexport class ListingMapviewPage {\n @ViewChild('map') mapElement: ElementRef;\n@ViewChild('searchbar', { read: ElementRef }) searchbar: ElementRef;\naddressElement: HTMLInputElement = null;\nlistSearch: string = '';\nmap: any;\nmarker: any;\nloading: any;\nsearch: boolean = false;\nerror: any;\nswitch: string = \"map\";\nloca:any;\nlact:any;\nlatitude:any;\nlongitude:any;\nselLoc:any;\nlocation:any;\nloc:any;\n location1:Object = {address:''};\n add : any;\n properties: any;\n property:any;\n public paged:any;\n public propertyStatus:any;\n public allData:any;\nregionals: any = [];\ncurrentregional: any;\nconstructor(\npublic navCtrl : NavController,\npublic loadingCtrl: LoadingController,\npublic toastCtrl: ToastController,\npublic app: App,\npublic nav: NavController,\npublic zone: NgZone,\npublic platform: Platform,\npublic alertCtrl: AlertController,\npublic actionSheetCtrl: ActionSheetController,\npublic geolocation: Geolocation,\nprivate viewCtrl:ViewController,\npublic events: Events,\nprivate propertyManager:PropertyProvider,\nprivate common:CommonProvider,\npublic userManager: UserManagerProvider\n) {\n  this.paged = 1;\n  this.propertyStatus = 'publish';\n  this.platform.ready().then(() => {\n    this.loading = this.loadingCtrl.create({\n      content: 'Getting location ...'\n    });\n    this.loading.present();\n    this.geolocation.getCurrentPosition({enableHighAccuracy:true}).then((res)=>{\n      this.loading.dismiss();\n      //this.latitude = res.coords.latitude;\n      //this.longitude = res.coords.longitude;\n\n      //-------static data \n      this.latitude = 25.9347377;\n      this.longitude = -80.1372757;\n\n      this.loadMaps();\n    });\n  });\n}\n\nloadMaps() {\n  if (!!google) {\n    this.initializeMap();\n    this.initAutocomplete();\n  } else {\n    this.errorAlert('Error', 'Something went wrong with the Internet Connection. Please check your Internet.')\n  }\n}\n\nerrorAlert(title, message) {\n  let alert = this.alertCtrl.create({\n    title: title,\n    message: message,\n    buttons: [{\n      text: 'OK',\n      handler: data => {\n      this.loadMaps();\n      }\n    }]\n  });\n  alert.present();\n}\n\ngetFomatedPrice(n){\n  //n = n.toFixed(2);\n  return \"$\"+n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nmapsSearchBar(ev: any) {\n  console.log(ev);\n  const autocomplete = new google.maps.places.Autocomplete(ev);\n  autocomplete.bindTo('bounds', this.map);\n  return new Observable((sub: any) => {\n    google.maps.event.addListener(autocomplete, 'place_changed', () => {\n      const place = autocomplete.getPlace();\n      if (!place.geometry) {\n        sub.error({\n        message: 'Autocomplete returned place with no geometry'\n        });\n      } else {\n        sub.next(place.geometry.location);\n        sub.complete();\n      }\n    });\n  });\n}\n\ninitAutocomplete(): void {\n  this.addressElement =\n  this.searchbar.nativeElement.querySelector('.searchbar-input');\n  this.createAutocomplete(this.addressElement).subscribe((location) => {\n    this.lact = location;\n    let options = {\n      center: location.geometry.location,\n      zoom: 12\n    };\n    this.map.setOptions(options);\n    this.addMarker(this.lact.geometry.location,this.lact.formatted_address);\n  });\n}\n\ncreateAutocomplete(addressEl: HTMLInputElement): Observable<any> {\n  const autocomplete = new google.maps.places.Autocomplete(addressEl);\n  autocomplete.bindTo('bounds', this.map);\n  return new Observable((sub: any) => {\n    google.maps.event.addListener(autocomplete, 'place_changed', () => {\n      const place = autocomplete.getPlace();\n      if (!place.geometry) {\n        sub.error({\n        message: 'Autocomplete returned place with no geometry'\n        });\n      } else {\n        this.loca = place;\n        this.events.publish('address', this.loca);\n        sub.next(place);\n      }\n    });\n  });\n}\n\ninitializeMap() {\n  let latLng = new google.maps.LatLng(this.latitude, this.longitude);\n  let mapOptions = {\n    center: latLng,\n    zoom: 12,\n    mapTypeId: google.maps.MapTypeId.TERRAIN\n  }\n  this.map = new google.maps.Map(this.mapElement.nativeElement, mapOptions);\n  this.addMarker(latLng ,'You are here');\n}\n\naddMarker(position, content) {\n    this.propertyManager.getListing(this.paged,this.propertyStatus).then((result)=>{\n          this.properties = result;\n          this.allData = this.properties.data\n            for(this.property of this.allData){\n              let latLng = new google.maps.LatLng(this.property.property_lat, this.property.property_lon);\n            \n              let marker = new google.maps.Marker({\n                map: this.map,\n                position: latLng\n              });\n\n                let content = '<div id=\"infoButton\"><img src=\"'+this.property.thumb+'\" width=\"220\"><h4>'+this.property.post_title+'</h4>';\n              content += '</p>Sq Ft : '+this.property.property_size+', Price: '+this.getFomatedPrice(this.property.property_price)+'</p></div>';\n              this.addInfoWindow(marker, content, this.property);\n            }\n\n });\n}\n\naddInfoWindow(marker, content, prop){\n \n  var infoWindow = new google.maps.InfoWindow({\n    content: content\n  });\n  let parent = this;\n  google.maps.event.addListener(marker, 'click', () => {\n    infoWindow.open(this.map, marker);\n  });\n\n  google.maps.event.addListenerOnce(infoWindow, 'domready', () => {\n    document.getElementById('infoButton').addEventListener('click', () => {\n            console.log('Clicked : ',prop);\n            this.navCtrl.push('PropertyDetailPage',{propertydata:prop});\n    });\n\n  });\n\n}\n\ncloseModal() {\n  this.viewCtrl.dismiss(this.loca);\n}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/listing-mapview/listing-mapview.ts"],"sourceRoot":""}